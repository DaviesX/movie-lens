The performance is not as good as the raw code. It might be due to my inability
of writing such code...
